---
import '../../styles/global.css';
import { getCollection } from 'astro:content';

import { transferImagesFormat } from '@/composables/transferImagesFormat';
import ArticlesContainer from '@/components/react/ArticlesContainer';
import { SITE_DESCRIPTION, SITE_TITLE } from '@/consts';
import DefaultLayout from '@/layouts/Default.astro';


// 모든 blog article 을 가져옵니다.
const articles = await getCollection('articles');
const transferedImagesFormatArticles = await transferImagesFormat(articles, 'webp');

// 최근 articles
const recentArticles = transferedImagesFormatArticles.sort((first, second) => {
  const firstDate = new Date(first.data.date.replace(/\./g, '-'));
  const secondDate = new Date(second.data.date.replace(/\./g, '-'));
  return secondDate.getTime() - firstDate.getTime();
});
---

<!doctype html>
<DefaultLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <ArticlesContainer client:load initialArticles={recentArticles} />
</DefaultLayout>